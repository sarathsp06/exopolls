<!DOCTYPE html>
<html>
   <head>
      <title>Polling Sample</title>
      <meta name="description" content="A cool thing made with HyperDev">
      <link id="favicon" rel="icon" href="https://hyperdev.com/favicon-app.ico" type="image/x-icon">
      <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <link rel="stylesheet" href="/style.css">
      <script src="https://code.jquery.com/jquery-3.1.1.min.js"   integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8="   crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.3.0/Chart.bundle.js"></script>
      
      <script>
          function UpdateChart(){
               $.get("exotel/polls", function( data ) {
                console.log(data)
                chart.data.datasets[0].data = [data['"1"'] || 0,data['"2"'] || 0,data['"3"'] || 0];
                chart.update();
                return true;
               });
             }
      
         function ChartUpdates(chart) {
             setInterval(UpdateChart,5000)
         }
         
         function LoadChart(){
         var ctx = document.getElementById("myChart");
         var myChart = new Chart(ctx, {
          responsive: true,
          maintainAspectRatio: false,
           type: 'pie',
           data : {
           labels: [
               "Good",
               "Ok",
               "Bad"
           ],
           datasets: [
               {   data: [0,0,0],
                   backgroundColor: [
                       "rgb(0, 0, 255)",
                       "rgb(0, 255,0)",
                       "rgb(255, 0, 0)"
                   ],
                   hoverBackgroundColor: [
                       "rgb(0,0,255)",
                       "rgb(0,255,0)",
                       "rgb(255,0,0)"
                   ]
               }]
         }
         });
         return myChart;
           
         }
      </script>
   </head>
   <body>
      <canvas id="myChart" style="display: block;width: auto;"></canvas>
      <script>
         var chart = LoadChart()
         UpdateChart()
         ChartUpdates(chart)
      </script>
   </body>
</html>